aws

create bucket 
aws s3 mb s3://stack-buck1-mike --profile [YOUR PROFILE NAME]

list buckets
aws s3api list-objects --bucket stack-buck1-mike  --query 'Contents[].{Key: Key, Size: Size}' --profile stack-5

delete bucket 
aws s3 rb s3://stack-buck1-mike --profile  stack-5 --force


empty bucket
aws s3 rm s3://mybucket --recursive
--exclude parameters
--aws s3 rm s3://mybucket/ --recursive --exclude "*.jpg"

tagging bucket
aws s3api put-bucket-tagging --bucket stack-buck1-mike --tagging file:///home/oracle/scripts/AWS_SCRIPTS/S3_JSON/org_tag.json --profile stack-5
aws s3api get-bucket-tagging --bucket stack-buck1-mike --profile stack-5


enable/ suspend versioning 
aws s3api put-bucket-versioning --bucket stack-buck1-mike  --versioning-configuration Status=Enabled --profile stack-5
ws s3api put-bucket-versioning --bucket stack-buck1-mike  --versioning-configuration Status=Suspended --profile stack-5
aws s3api get-bucket-versioning --bucket stack-buck1-mike --profile stack-5



encryption
aws s3api get-bucket-encryption --bucket stack-buck1-mike --profile stack-5
aws s3api put-bucket-encryption --bucket  stack-buck1-mike --server-side-encryption-configuration '{
 "Rules": [
         {
             "ApplyServerSideEncryptionByDefault": {
                 "SSEAlgorithm": "AES256"
             }
         }
     ]
 }' --profile stack-5


kms (key managed store) encrytion
aws s3api put-bucket-encryption --bucket stack-buck1-mike  --server-side-encryption-configuration '{
>     "Rules": [
>         {
>             "ApplyServerSideEncryptionByDefault": {
>                 "KMSMasterKeyID": "arn:aws:kms:us-east-1:XXXXXXXXXX:key/914fa116-a144-49b2-a82f-718b068af32f",
>                 "SSEAlgorithm": "aws:kms"
>             }
>         }
>     ]
> }' --profile stack-5

aws s3api get-bucket-encryption --bucket stack-buck1-mike --profile stack-5
{
    "ServerSideEncryptionConfiguration": {
        "Rules": [
            {
                "ApplyServerSideEncryptionByDefault": {
                    "KMSMasterKeyID": "arn:aws:kms:us-east-1:xxxxxxxxxxxxx:key/914fa116-a144-49b2-a82f-718b068af32f",
                    "SSEAlgorithm": "aws:kms"
                }
            }
        ]
    }
}




encrypt while copying file
aws s3 cp aws_control_template.sh s3://stack-buck1-mike --sse aws:kms


remove encrtion on a bucket level 
aws s3api delete-bucket-encryption --bucket stack-buck1-mike
aws s3api get-bucket-encryption --bucket stack-buck1-mike


Enable Server Access Logging
aws s3api get-bucket-logging --bucket stack-buck1-mike
aws s3api put-bucket-acl --bucket stack-buck1-mike --grant-write 


object level logging 
aws cloudtrail describe-trails



appendix
tagging
To track the storage cost or other criteria for individual projects or groups of projects, 
label your Amazon S3 buckets using cost allocation tags. A cost 
allocation tag is a key-value pair that you associate with an S3 
bucket. After you activate cost allocation 

encrytion
Amazon S3 default encryption provides a way to set the default 
encryption behavior for an S3 bucket. You can set default 
encryption on a bucket so that all objects are encrypted when 
they are stored in the bucket. The objects are encrypted using 
server-side encryption with either Amazon S3-managed keys (SSE-S3) or AWS KMS-managed keys (SSE-KMS).

Without default encryption, to encrypt all objects stored in a 
bucket, you must include encryption information with every 
object storage request. You must also set up an S3 bucket policy 
to reject storage requests that don't include encryption information.



STACK-S3-TF/src/main/tf/.terraform/*
STACK_IAM-TF/src/main/tf/.terraform/*